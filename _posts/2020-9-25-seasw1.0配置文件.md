## 需要连接控制器时的配置文件cli，此时需要加载io核、msg核、fe核
```
[root@seasw app]# cat seasw.cli 
mempool MEMPOOL0 buffer 2304 pool 512K cache 256 cpu 0
mempool MEMPOOL1 buffer 2304 pool 512K cache 256 cpu 0

swq SWQ size 1024 cpu 0

protocol PROT0 mempool MEMPOOL1 pof 192.168.101.17 6643 dpid 163

link LINK0 dev 0000:3b:00.0 rxq 1 512 MEMPOOL0 txq 1 1024 promiscuous on
link LINK1 dev 0000:3b:00.1 rxq 1 512 MEMPOOL0 txq 1 1024 promiscuous on
link LINK2 dev 0000:3b:00.2 rxq 1 512 MEMPOOL0 txq 1 1024 promiscuous on


pipeline P0 period 5 offset_port_id 0 cpu 0 counter 100 iblock 65530

pipeline P0 port in bsz 32 link LINK0 rxq 0
pipeline P0 port in bsz 32 link LINK1 rxq 0
pipeline P0 port in bsz 32 link LINK2 rxq 0
pipeline P0 port in bsz 1 swq SWQ
 
pipeline P0 port out bsz 1 link LINK0 txq 0
pipeline P0 port out bsz 1 link LINK1 txq 0
pipeline P0 port out bsz 1 link LINK2 txq 0
pipeline P0 port out bsz 1 swq SWQ

;pipeline P0 asm asm/ex.bin
pipeline P0 protocol PROT0

control 2 pipeline P0 io        io占一个核
control 4 pipeline P0 msg       msg占一个核
thread 6 pipeline P0 enable     fe占一个或更多核
```

## asm文件中的table_size代表该表的大小，最多能放多少个表项
```
table	t0, 0, mm, 8
	match   v6_protocol
	match   v6_sIP
	match   v6_dIP
	match   sport
	match   dport
	entry   entry0
endtable
```

## asm文件中的matchx使用掩码匹配，匹配条件：得到数据包的值 与 后面的值 == 前面的值
```
entry   entry2, 0, goto3
        priority	1
        itime      	0
	matchx          v6_protocol, 0x0000, 0x0000
	matchx          v6_sIP, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000
	matchx          v6_dIP, 0x00000000000000000000000000000000, 0x00000000000000000000000000000000
	matchx          sport, 0x0000, 0x0000
	matchx          dport, 0x0000, 0x0000

endentry
```

## 配置文件中的`inport`匹配项的匹配顺序是所有被dpdk绑定的网卡顺序！！！这个与cli文件是否加载某个网卡及其设备号无关！！所以在实验之前，如果需要使用inport字段，最好dpdk绑定的网卡不要
比如dpdk绑定了abc三个网卡端口，即使在cli配置文件中只调用了ac，其中的asm文件中的inport 2依然是b号网口

附录：
1. asm文件示例
outm.asm文件：

   ```
   [root@localhost app]# cat asm/outm.asm 
   	name example ;配置文件名
   
   ;**************************************************************
   ;*  func: t1(em) match inport, ouput port 1                         
   ;**************************************************************
   
   ;**************************************************************
   ;*  packet                                                    *
   ;**************************************************************
   
   ; ETHernet header  offset(0)
   ;
   	field	dst_mac = 1(0,48)
   	field	src_mac = 1(48,48)
   	field	type    = 1(96,16)
   	field	saddr = 1(208,32)	; source IP
   	field	daddr = 1(240,32)	; destination IP
   
   ;**************************************************************
   ;*  global metadata                                           *
   ;**************************************************************
   ;包的metadata，元数据
   	field	n_pkts = 3(0,32);
   
   ;**************************************************************
   ;*  Counter                                                   *
   ;**************************************************************
   ;计数器counter
   	counter cnt1, 1
   	counter cnt2, 2
   
   ;**************************************************************
   ;*  Table                                                     *
   ;**************************************************************
   ;流表，只有一个流表，其中有一个entry1表项。匹配到“包结构分段”中的“type”字段，则进入entry1处理程序
   table	t1, 0, em, 8
   	match   type
   	entry   entry1
   endtable
   
   
   ;**************************************************************
   ;*  entry                                                     *
   ;**************************************************************
   ;表达对于匹配到type值为0x0800（掩码0x0000）的包，执行以下指令
   entry   entry1, 0, output
           priority	1
   		counter		0
           itime      	0
   	matchx          type, 0x0800, 0x0000 
   endentry	
   
   ;指令细节，outm代表出端口，sfd代表修改saddr为0x11111111
   proc	output, 0
   	outm	4
   	sfd 	saddr, 0x11111111
   	outm 	1
   	sfd 	saddr, 0x22222222
   	;outp 	1
   	tocp    1, 1500
   	exit
   endproc
   
   start	t1
   ```

   2. cli文件示例
   ```
   [root@localhost app]# vi seasw.cli 
   ;这个文档以;符号作为注释符
   mempool MEMPOOL0 buffer 2304 pool 512K cache 256 cpu 0
   mempool MEMPOOL1 buffer 2304 pool 512K cache 256 cpu 0
   ;内存分配，内存池信息
   
   swq SWQ size 1024 cpu 0
   ;swq为某种队列？
   ;protocol PROT0 mempool MEMPOOL1 pof 192.168.101.13 6643 dpid 3
   
   link LINK0 dev 0000:02:00.0 rxq 1 512 MEMPOOL0 txq 1 1024 promiscuous on
   link LINK1 dev 0000:02:00.1 rxq 1 512 MEMPOOL0 txq 1 1024 promiscuous on
   ;绑定的网卡，注意要将网卡的数量和设备号更改正确，使用dpdk脚本或lscpi |grep Ethernet查看
   ;本例中dpdk程序绑定了两张网卡，分别为LINK0和LINK1，设备号分别为0000:02:00.0、0000:02:00.1
   
   pipeline P0 period 5 offset_port_id 0 cpu 0 counter 100 iblock 65530
   
   pipeline P0 port in bsz 32 link LINK0 rxq 0
   pipeline P0 port in bsz 32 link LINK1 rxq 0
   pipeline P0 port in bsz 1 swq SWQ
   ;注意同步修改
   
   pipeline P0 port out bsz 1 link LINK0 txq 0
   pipeline P0 port out bsz 1 link LINK1 txq 0
   pipeline P0 port out bsz 1 swq SWQ
   ;注意同步修改
   
   pipeline P0 asm asm/ex.bin
   ;使用asm/ex.bin作为控制器流表的模拟配置文件
   
   ;pipeline P0 protocol PROT0
   "seasw.cli" 26L, 752C written
   ```
